{% load static %}
<!DOCTYPE html>
<html lang="en" data-textdirection="ltr">
<!-- BEGIN: Head-->


<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=0,minimal-ui">
    <meta name="description" content="Bikedoot">
    <meta name="keywords" content="Bikedoot, web app">
    <meta name="author" content="Bikedoot">
    <title>Bikedoot-{% block title %}{% endblock %}</title>
    <link rel="apple-touch-icon" href="{% static 'app-assets/images/ico/apple-icon-120.png' %}">
    <link rel="shortcut icon" type="image/x-icon" href="../../../static/custom-assets/images/bikedoot/ServXPNG.png">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,300;0,400;0,500;0,600;1,400;1,500;1,600"
        rel="stylesheet">
    <!-- Local Inter Font -->
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/fonts/inter/inter.css' %}">

    <!-- BEGIN: OLD CSS-->
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/vendors/css/vendors.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/fonts/font-awesome/css/font-awesome.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/vendors/css/extensions/jstree.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/vendors/css/charts/apexcharts.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/vendors/css/extensions/toastr.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/vendors/css/extensions/sweetalert2.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/vendors/css/pickers/pickadate/pickadate.css' %}">
    <link rel="stylesheet" type="text/css"
        href="{% static 'app-assets/vendors/css/pickers/flatpickr/flatpickr.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/vendors/css/forms/select/select2.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/vendors/css/editors/quill/katex.min.css' %}">
    <link rel="stylesheet" type="text/css"
        href="{% static 'app-assets/vendors/css/editors/quill/monokai-sublime.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/vendors/css/editors/quill/quill.snow.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/vendors/css/animate/animate.min.css' %}">
    <link rel="stylesheet" type="text/css"
        href="{% static 'app-assets/vendors/css/tables/datatable/dataTables.bootstrap5.min.css' %}">
    <link rel="stylesheet" type="text/css"
        href="{% static 'app-assets/vendors/css/tables/datatable/responsive.bootstrap5.min.css' %}">
    <link rel="stylesheet" type="text/css"
        href="{% static 'app-assets/vendors/css/tables/datatable/buttons.bootstrap5.min.css' %}">
    <link rel="stylesheet" type="text/css"
        href="{% static 'app-assets/vendors/css/tables/datatable/rowGroup.bootstrap5.min.css' %}">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="stylesheet" type="text/css"
        href="https://fonts.googleapis.com/css2?family=Inconsolata&amp;family=Roboto+Slab&amp;family=Slabo+27px&amp;family=Sofia&amp;family=Ubuntu+Mono&amp;display=swap">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/bootstrap.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/bootstrap-extended.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/colors.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/components.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/themes/dark-layout.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/themes/bordered-layout.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/themes/semi-dark-layout.css' %}">
    <link rel="stylesheet" type="text/css"
        href="{% static 'app-assets/css/core/menu/menu-types/horizontal-menu.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/pages/dashboard-ecommerce.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/plugins/charts/chart-apex.css' %}">
    <link rel="stylesheet" type="text/css"
        href="{% static 'app-assets/css/plugins/extensions/ext-component-toastr.css' %}">
    <link rel="stylesheet" type="text/css"
        href="{% static 'app-assets/css/plugins/forms/pickers/form-flat-pickr.css' %}">
    <link rel="stylesheet" type="text/css"
        href="{% static 'app-assets/css/plugins/forms/pickers/form-pickadate.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/pages/app-chat-list.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/pages/page-blog.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/plugins/forms/form-quill-editor.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/pages/app-email.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/plugins/forms/form-validation.css' %}">
    <link rel="stylesheet" type="text/css"
        href="{% static 'app-assets/css/plugins/extensions/ext-component-sweet-alerts.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/pages/page-profile.css' %}">
    <link rel="stylesheet" type="text/css"
        href="{% static 'app-assets/css/plugins/extensions/ext-component-tree.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/pages/app-file-manager.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/vendors/css/extensions/swiper.min.css' %}">
    <link rel="stylesheet" type="text/css"
        href="{% static 'app-assets/css/plugins/extensions/ext-component-swiper.css' %}">
    <script src="{% static 'app-assets/vendors/js/extensions/sweetalert2.all.min.js' %}"></script>
    <!-- END: OLD CSS-->

    {% block style %}{% endblock %}

    <!--START: NEW CSS-->
    <!-- <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/core/menu/menu-types/vertical-menu.css' %}"> -->
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/data/locales/en.json' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'app-assets/css/pages/app-todo.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'custom-assets/css/sidebar-improvements.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'custom-assets/css/mobile-navbar-fix.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'custom-assets/css/desktop-sidebar.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <script src="{% static 'app-assets/vendors/js/extensions/dragula.min.js' %}"></script>
    <!--END: NEW CSS-->

    <style>
        .set-background-color {
            background-color: #3b82f6 !important;
        }

        .set-text-color {
            color: #3b82f6 !important;
        }

        .subsection-group.active>a {
            background-color: #3b82f6 !important;
            color: white !important;
        }

        .subsection-group.active>a span,
        .subsection-group.active>a i {
            color: white !important;
        }

        .subsection-group.active>a:hover span,
        .subsection-group.active>a:hover i {
            color: #6c757d !important;
        }
    </style>
    <!-- IMMEDIATE MOBILE FIXES - HIGHEST PRIORITY -->
    <style>
        /* FORCE REMOVE ALL BLUR EFFECTS - INLINE STYLE PRIORITY */
        .main-menu,
        .main-menu *,
        .shadow-bottom,
        #main-sidebar,
        #main-sidebar * {
            filter: none !important;
            -webkit-filter: none !important;
            backdrop-filter: none !important;
            -webkit-backdrop-filter: none !important;
        }

        .shadow-bottom {
            display: none !important;
        }
    </style>
    <style>
        /* FORCE NAVBAR FULL WIDTH - NO RIGHT SPACE */
        @media (max-width: 991.98px) {

            /* Fix sidebar z-index to prevent overlap with main content */
            body .main-menu {
                z-index: 1050 !important;
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                transform: translateX(-100%) !important;
                transition: transform 0.3s ease !important;
            }

            body .main-menu.show {
                transform: translateX(0) !important;
            }

            /* Ensure main content doesn't overlap when sidebar is closed */
            body .main-content {
                margin-left: 0 !important;
                width: 100% !important;
            }

            body .header-navbar.navbar.navbar-expand-lg.floating-nav.navbar-light.navbar-shadow.container-xxl,
            body nav.header-navbar,
            body .header-navbar {
                width: 100vw !important;
                max-width: 100vw !important;
                left: 0 !important;
                right: 0 !important;
                margin: 0 !important;
                padding: 0 !important;
                box-sizing: border-box !important;
                position: fixed !important;
                top: 0 !important;
            }

            body .header-navbar .navbar-container.d-flex.content,
            body .header-navbar .navbar-container {
                width: 100% !important;
                max-width: 100% !important;
                margin: 0 !important;
                padding: 0.5rem 0.75rem !important;
                box-sizing: border-box !important;
                justify-content: space-between !important;
            }

            /* USER ICON AT RIGHTMOST EDGE */
            body .header-navbar .navbar-nav.ms-auto {
                margin-right: 0 !important;
                padding-right: 0 !important;
                display: flex !important;
                align-items: center !important;
                justify-content: flex-end !important;
            }

            body .header-navbar .dropdown-user {
                margin-right: 0 !important;
                padding-right: 0 !important;
                display: flex !important;
                align-items: center !important;
            }

            body .header-navbar .dropdown-user .nav-link {
                padding: 0.25rem 0 0.25rem 0.5rem !important;
                display: flex !important;
                align-items: center !important;
                justify-content: flex-end !important;
                gap: 0.5rem !important;
            }

            /* Position user name and icon at absolute right */
            body .header-navbar .user-nav {
                text-align: right !important;
                margin-right: 0.25rem !important;
                display: flex !important;
                flex-direction: column !important;
                align-items: flex-end !important;
                justify-content: center !important;
            }

            /* Adjust avatar positioning - move slightly up */
            body .header-navbar .avatar {
                margin: 0 !important;
                display: flex !important;
                align-items: center !important;
                transform: translateY(-1px) !important;
            }

            body .header-navbar .avatar img {
                width: 36px !important;
                height: 36px !important;
                border-radius: 50% !important;
            }

            /* MINIMAL GAP BETWEEN NAVBAR AND CONTENT */
            body .main-content {
                padding-top: 60px !important;
                margin-top: 0 !important;
            }

            body .main-content .app-content,
            body .app-content,
            body .content-wrapper {
                padding-top: 0 !important;
                margin-top: 0 !important;
            }

            body h1,
            body h2,
            body h3,
            body h4,
            body h5,
            body h6 {
                margin-top: 0 !important;
                padding-top: 0 !important;
                margin-bottom: 0.25rem !important;
            }

            /* DASHBOARD CARD SPACING FOR MOBILE */
            body .card {
                margin-bottom: 1rem !important;
            }

            body .row>.col,
            body .row>[class*="col-"] {
                margin-bottom: 1rem !important;
            }

            /* Specific spacing for dashboard cards */
            body .card+.card,
            body .col-12+.col-12,
            body .col-md-6+.col-md-6 {
                margin-top: 0.75rem !important;
            }

            /* OVERRIDE ANY BOOTSTRAP CONTAINERS */
            body .header-navbar .container,
            body .header-navbar .container-fluid,
            body .header-navbar .container-xxl {
                max-width: none !important;
                width: 100% !important;
                padding-left: 1rem !important;
                padding-right: 0 !important;
                margin: 0 !important;
            }
            
            /* DATE RANGE PICKER MOBILE STYLES - ICON ONLY */
            #dateRangePicker {
                display: none !important;
            }
            
            .data-range-picker .input-group-text {
                padding: 0.6rem !important;
                border-radius: 6px !important;
                border: 1px solid #d8d6de !important;
                background: #f8f9fa !important;
                cursor: pointer !important;
            }
        }
    </style>
    <!-- Font Awesome for Icons -->
    <style>
        /* Enhanced GMS Branding with 6-degree corner styling */
        .main-menu .main-menu-content .navigation-main .nav-item {
            text-align: center;
            margin: 1.5rem 0;
        }

        .main-menu .main-menu-content .navigation-main .nav-item a {
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 0.5rem 0;
            color: white;
        }

        .main-menu .main-menu-content .navigation-main .nav-item .icon-label-stack {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .main-menu .main-menu-content .navigation-main .nav-item .icon-label-stack i {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
            line-height: 1;
        }

        .main-menu .main-menu-content .navigation-main .nav-item .icon-label-stack .menu-title {
            font-size: 1.1rem;
            font-weight: 500;
        }

        .main-menu .main-menu-content .navigation-main .nav-item.active {
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
        }

        .main-menu .main-menu-content .navigation-main {
            padding: 0 1rem;
        }

        /* Enhanced GMS branding with rectangular corner background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            right: 0;
            width: 200px;
            height: 80px;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(59, 130, 246, 0.05));
            border-radius: 0 0 0 8px;
            z-index: -1;
            pointer-events: none;
        }

        /* Additional corner styling for main content */
        .main-content::before {
            content: '';
            position: absolute;
            top: 20px;
            right: 20px;
            width: 150px;
            height: 60px;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.08), rgba(59, 130, 246, 0.03));
            border-radius: 6px;
            z-index: -1;
            pointer-events: none;
        }

        /* Enhanced GMS text styling in headers */
        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            position: relative;
        }

        h1:first-child::after,
        .page-title::after {
            content: 'GMS';
            position: absolute;
            top: -10px;
            right: -60px;
            font-size: 0.6em;
            font-weight: 700;
            color: rgba(59, 130, 246, 0.3);
            letter-spacing: 0.1em;
            padding: 2px 6px;
            background: rgba(59, 130, 246, 0.05);
            border-radius: 3px;
            z-index: 1;
            pointer-events: none;
        }
    </style>
    <style>
        .arrow {
            margin-left: 10px;
            /* Space between text and arrow */
            font-size: 0.8em;
            /* Adjust size as necessary */
            color: #6c757d;
            /* Default text color */
        }

        .custom-select-icon {
            margin-right: 5px;
            /* Reduce space between icon and text */
        }

        #selectedValue {
            flex-grow: 2;
            /* Allow selectedValue to take up remaining space */
        }
    </style>
    <style>
        /* Dropdown menu positioning */
        .nav-item.dropdown {
            position: relative;
        }

        /* Sidebar (left) flyout dropdowns only */
        .main-menu .nav-item.dropdown .dropdown-menu {
            position: absolute !important;
            left: 100% !important;
            top: 0 !important;
            margin-top: 0 !important;
            margin-left: 0.5rem !important;
            min-width: 220px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 0.357rem;
            background: #fff;
            color: #333;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
            display: none;
            z-index: 1200;
        }

        /* Show when active */
        .main-menu .nav-item.dropdown .dropdown-menu.show {
            display: block;
        }

        /* Ensure sidebar allows overflow for flyout */
        .main-menu,
        .main-menu .main-menu-content,
        .main-menu .navigation {
            overflow: visible !important;
        }

        /* Header (top-right) user dropdown */
        .header-navbar .nav-item.dropdown .dropdown-menu {
            position: absolute !important;
            right: 0 !important;
            left: auto !important;
            top: 100% !important;
            margin-top: 0.25rem !important;
            z-index: 1050;
        }

        /* Ensure navbar allows dropdown to overflow */
        .header-navbar {
            position: relative;
            z-index: 1100;
            /* above overlays */
            overflow: visible !important;
        }

        .header-navbar .navbar-container {
            overflow: visible !important;
        }

        /* Make dropdown visible when toggled via .show */
        .header-navbar .dropdown-menu {
            display: none;
            background-color: #ffffff;
            color: #333;
            border: 1px solid rgba(0, 0, 0, 0.1);
            border-radius: 0.357rem;
            min-width: 12rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .header-navbar .dropdown-menu.show {
            display: block;
        }

        /* Ensure dropdown is clickable */
        .dropdown-toggle::after {
            display: none !important;
        }

        /* Add arrow to dropdown items with children */
        .dropdown-item.has-submenu::after {
            content: 'â†’';
            float: right;
            margin-left: 10px;
        }

        /* Hover effect for dropdown items */
        .dropdown-item:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        /* Sidebar icon and text styling */
        .navigation .nav-item a {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 12px 0;
        }

        .icon-label-stack {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
        }

        .navigation .nav-item a i {
            margin-bottom: 6px;
            font-size: 1.3rem;
            transition: transform 0.2s ease;
            display: block;
        }

        .navigation .nav-item a .menu-title {
            display: block;
            width: auto;
            text-align: center;
            font-size: 0.98rem;
            margin: 0 auto 0 auto;
            padding: 0;
            line-height: 1.2;
            white-space: normal;
            overflow: visible;
        }

        .menu-title[data-item="home"] {
            margin-left: -1px;
        }

        .navigation .nav-item a i {
            margin-bottom: 6px;
            font-size: 1.3rem;
            transition: transform 0.2s ease;
            display: block;
        }

        .navigation .nav-item a .menu-title {
            display: block;
            width: auto;
            text-align: center;
            font-size: 0.98rem;
            margin: 0;
            padding: 0;
            line-height: 1.2;
            white-space: normal;
            overflow: visible;
        }

        .navigation .nav-item a:hover,
        .navigation li a:hover {
            background-color: rgba(90, 141, 238, 0.2);
            transition: background-color 0.15s ease;
        }

        /* Prevent tooltips and popups from appearing */
        .navigation .nav-item a,
        .navigation li a {
            pointer-events: auto;
            text-decoration: none;
        }

        /* Disable submenu expand behavior */
        .main-menu .navigation li.has-sub>a:after {
            display: none !important;
        }

        .main-menu .navigation li.has-sub ul.menu-content {
            display: none !important;
        }

        /* Disable all menu expansion */
        .main-menu .navigation li.has-sub {
            cursor: default !important;
        }

        .navigation .nav-item a::before,
        .navigation .nav-item a::after,
        .navigation li a::before,
        .navigation li a::after {
            display: none !important;
            content: none !important;
        }

        /* Global tooltip suppression */
        [title] {
            position: relative;
        }

        [title]:hover::after {
            display: none !important;
            content: none !important;
        }

        /* Specific rule for timesheet */
        a[href*="timesheet"],
        #timesheet-menu-item a,
        .no-tooltip {
            pointer-events: auto;
            text-indent: 0;
        }

        a[href*="timesheet"]:hover::before,
        a[href*="timesheet"]:hover::after,
        #timesheet-menu-item a:hover::before,
        #timesheet-menu-item a:hover::after,
        .no-tooltip:hover::before,
        .no-tooltip:hover::after {
            display: none !important;
            content: none !important;
            opacity: 0 !important;
            visibility: hidden !important;
        }

        /* Disable tooltips for Bootstrap */
        .tooltip {
            display: none !important;
            opacity: 0 !important;
            visibility: hidden !important;
        }

        /* Remove transform effect on hover */
        .navigation .nav-item a:hover i {
            transform: none;
        }


        .navigation .nav-item a .menu-title,
        .navigation li a .menu-item {
            font-size: 0.7rem;
            margin-top: 4px;
            line-height: 1.2;
            width: 100%;
            min-width: 88px;
            display: block;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-weight: 600;
            color: #565656;
            transition: color 0.2s ease;
        }

        .navigation .nav-item a:hover .menu-title,
        .navigation li a:hover .menu-item {
            color: #2f2f2f;
        }

        /* Actively selected menu item */
        .navigation .active>a .menu-title {
            color: #fff !important;
            font-weight: 500;
        }


        /* Style for active submenu items */
        .main-menu .navigation li .active>a {
            color: #fff !important;
        }

        /* Add more width to the menu items */
        .main-menu.menu-fixed {
            width: 110px !important;
            z-index: 1031 !important;
            position: fixed;
            height: 100%;
        }

        .navigation>li>a {
            padding: 10px 5px;
            margin: 0 auto;
        }

        /* Ensure submenu items are also styled properly */
        .navigation li>ul li>a {
            padding: 8px 4px;
        }
    </style>
    <style>
        /* Mobile menu styles */
        @media (max-width: 991.98px) {
            .main-menu {
                transform: translateX(-100%);
                transition: transform 0.3s ease-in-out;
                z-index: 1032;
            }

            .main-menu.show {
                transform: translateX(0);
                box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            }

            .menu-open {
                overflow: hidden;
            }

            .menu-open::after {
                content: '';
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0, 0, 0, 0.5);
                z-index: 1031;
                transition: opacity 0.3s ease-in-out;
            }

            /* Adjust header for mobile */
            .header-navbar {
                padding: 0.5rem 1rem;
            }

            /* Style the hamburger button */
            #mobile-menu-toggle {
                background: #3b82f6;
                border: 2px solid rgba(255, 255, 255, 0.3);
                border-radius: 6px;
                padding: 0.6rem;
                margin: 0 1rem 0 0.5rem;
                cursor: pointer;
                display: none;
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
                transition: all 0.3s ease;
            }

            #mobile-menu-toggle:hover {
                background: #2563eb;
                transform: scale(1.05);
            }

            #mobile-menu-toggle i {
                color: white;
                font-size: 1.5rem;
                display: flex;
                align-items: center;
                justify-content: center;
                width: 24px;
                height: 24px;
            }

            @media (max-width: 991.98px) {
                #mobile-menu-toggle {
                    display: block;
                }
            }
        }
    </style>
    <style>
        /* Sidebar styling */
        .main-menu {
            background-color: #3b82f6 !important;
        }

        .main-menu-content {
            background-color: #3b82f6 !important;
        }

        .navigation {
            background-color: #3b82f6 !important;
            color: white !important;
        }

        .navigation a {
            color: white !important;
        }

        .navigation i {
            color: white !important;
        }

        .navigation .nav-item {
            color: white !important;
        }

        .navigation .menu-title {
            color: white !important;
        }

        .navigation .icon-label-stack {
            color: white !important;
        }

        .navigation .nav-item:hover {
            background-color: rgba(255, 255, 255, 0.1) !important;
        }
    </style>
    <!-- Override to disable sidebar popup menus -->
    <style>
        .main-menu-content .menu-content,
        .vertical-menu-modern .main-menu-content .navigation li.has-sub>.menu-content {
            display: none !important;
            height: 0 !important;
            opacity: 0 !important;
            visibility: hidden !important;
            overflow: hidden !important;
            transform: none !important;
            transition: none !important;
        }

        /* Completely hide sidebar menu flyout/hover popups */
        body .main-menu .main-menu-content .navigation-main .nav-item .menu-content,
        body .main-menu .main-menu-content .navigation-main .nav-item .hover,
        body .main-menu .main-menu-content .navigation-main .nav-item .menu-title:after,
        body .main-menu .main-menu-content .navigation-main .nav-item .menu-title:before,
        body .main-menu .main-menu-content .navigation-main .nav-item .menu-title[style*="block"],
        body .main-menu .main-menu-content .navigation-main .nav-item .menu-title[style*="visible"] {
            display: none !important;
            opacity: 0 !important;
            visibility: hidden !important;
            pointer-events: none !important;
        }
    </style>
    <style>
        .loader-wrapper {
            display: none !important;
        }

        /* for breadcrumb */
        .content-header .row {
            display: none !important;
        }
    </style>

    <style>
        @media (max-width: 768px) {
            html body div.app-content {
                padding: calc(-18rem - -0.2rem + -20rem + -20rem) calc(-1rem - -0.2rem) 0 calc(-2rem - 0.8rem) !important;
            }

            html body .card {
                margin: 0px -16px 0px -9px !important;
            }

            /* html body .card-body{
    margin:0px -26px 0px -23px !important;
  } */
        }
    </style>
</head>
<!-- END: Head-->

<!-- BEGIN: Body-->

<body
    class="vertical-layout vertical-menu-modern navbar-floating footer-static menu-collapsed d-flex flex-column min-vh-100"
    data-open="click" data-menu="vertical-menu-modern" data-col="" style="min-height: 100vh;">
    <!-- BEGIN: Header container -->
    <div class="main-content flex-grow-1">
        <nav
            class="header-navbar navbar navbar-expand-lg align-items-center floating-nav navbar-light navbar-shadow container-xxl">
            <div class="navbar-container d-flex content">
                <!-- Mobile menu button -->
                <button class="navbar-toggler d-xl-none d-block" id="mobile-menu-toggle" type="button"
                    aria-label="Toggle navigation">
                </button>
                <!-- Dynamic header subsections container -->
                <ul class="nav navbar-nav align-items-center" id="header-subsections">
                    <!-- Dashboard Summary -->
                    <li class="nav-item subsection-group" data-menu="dashboard" style="display: none;">
                        <a class="nav-link" href="{% url 'r-home' %}"
                            style="color: #6c757d; font-weight: 500; display: flex; align-items: center; padding: 8px 12px; border-radius: 6px; transition: all 0.3s ease;"
                            onmouseover="this.style.background='#f8f9fa'; this.style.color='#495057'"
                            onmouseout="this.style.background='transparent'; this.style.color='#6c757d'">
                            <i data-feather="bar-chart-2" style="width: 16px; height: 16px; margin-right: 6px;"></i>
                            <span>Summary</span>
                        </a>
                    </li>

                    <!-- Jobcards Summary -->
                    <li class="nav-item subsection-group" data-menu="jobcards" style="display: none;">
                        <a class="nav-link" href="{% url 'r-txn-job-sheets' %}"
                            style="color: #6c757d; font-weight: 500; display: flex; align-items: center; padding: 8px 12px; border-radius: 6px; transition: all 0.3s ease;"
                            onmouseover="this.style.background='#f8f9fa'; this.style.color='#495057'"
                            onmouseout="this.style.background='transparent'; this.style.color='#6c757d'">
                            <i data-feather="bar-chart-2" style="width: 16px; height: 16px; margin-right: 6px;"></i>
                            <span>Summary</span>
                        </a>
                    </li>

                    <!-- staff Summary -->
                    <li class="nav-item subsection-group" data-menu="staff" style="display: none;">
                        <a class="nav-link" href="{% url 'r-staff' %}"
                            style="color: #6c757d; font-weight: 500; display: flex; align-items: center; padding: 8px 12px; border-radius: 6px; transition: all 0.3s ease;"
                            onmouseover="this.style.background='#f8f9fa'; this.style.color='#495057'"
                            onmouseout="this.style.background='transparent'; this.style.color='#6c757d'">
                            <i data-feather="bar-chart-2" style="width: 16px; height: 16px; margin-right: 6px;"></i>
                            <span>Summary</span>
                        </a>
                    </li>

                    <!-- for createjob sheet -->

                    <li class="nav-item subsection-group" data-menu="readjobsheet" style="display: none;">
                        <a class="nav-link" href="{% url 'job-sheets-vehicletype' %}"
                            style="color: #6c757d; font-weight: 500; display: flex; align-items: center; padding: 8px 12px; border-radius: 6px; transition: all 0.3s ease;"
                            onmouseover="this.style.background='#f8f9fa'; this.style.color='#495057'"
                            onmouseout="this.style.background='transparent'; this.style.color='#6c757d'">
                            <i data-feather="bar-chart-2" style="width: 16px; height: 16px; margin-right: 6px;"></i>
                            <span>Summary</span>
                        </a>
                    </li>

                    <!-- <li class="nav-item subsection-group" data-menu="r_jobsheet" style="display: none;">
                        <a class="nav-link" href="{% url 'job-sheets-vehicletype' %}" style="color: #6c757d; font-weight: 500; display: flex; align-items: center; padding: 8px 12px; border-radius: 6px; transition: all 0.3s ease;" onmouseover="this.style.background='#f8f9fa'; this.style.color='#495057'" onmouseout="this.style.background='transparent'; this.style.color='#6c757d'">
                            <i data-feather="bar-chart-2" style="width: 16px; height: 16px; margin-right: 6px;"></i>
                            <span>Summary</span>
                        </a>
                    </li> -->

                    {% block navlink %}{% endblock %}


                    <!-- profile  -->
                    <!-- <li class="nav-item subsection-group" data-menu="profile-summary" style="display: none;">
                        <a class="nav-link" href="{% block profile_url %}#{% endblock %}" style="color: #6c757d; font-weight: 500; display: flex; align-items: center; padding: 8px 12px; border-radius: 6px; transition: all 0.3s ease;" onmouseover="this.style.background='#f8f9fa'; this.style.color='#495057'" onmouseout="this.style.background='transparent'; this.style.color='#6c757d'">
                            <i data-feather="bar-chart-2" style="width: 16px; height: 16px; margin-right: 6px;"></i>
                            <span>Summary</span>
                        </a>
                    </li> -->







                    <!-- Transactions subsections -->
                    {% if 'Transactions' in useruiacl %}
                    <li class="nav-item subsection-group" data-menu="transactions" style="display: none;">
                        <a class="nav-link" href="{% url 'r-transactions' %}"
                            style="color: #6c757d; font-weight: 500; display: flex; align-items: center; padding: 8px 12px; border-radius: 6px; transition: all 0.3s ease;"
                            onmouseover="this.style.background='#f8f9fa'; this.style.color='#495057'"
                            onmouseout="this.style.background='transparent'; this.style.color='#6c757d'">
                            <i data-feather="bar-chart-2" style="width: 16px; height: 16px; margin-right: 6px;"></i>
                            <span>Summary</span>
                        </a>
                    </li>
                    {% if 'Estimates' in useruiacl.Transactions %}
                    <li class="nav-item subsection-group" data-menu="transactions" style="display: none;">
                        <a class="nav-link" href="{% url 'r-txn-estimates' %}"
                            style="color: #6c757d; font-weight: 500; display: flex; align-items: center; padding: 8px 12px; border-radius: 6px; transition: all 0.3s ease;"
                            onmouseover="this.style.background='#f8f9fa'; this.style.color='#495057'"
                            onmouseout="this.style.background='transparent'; this.style.color='#6c757d'">
                            <i data-feather="file-text" style="width: 16px; height: 16px; margin-right: 6px;"></i>
                            <span>Estimate</span>
                        </a>
                    </li>
                    {% endif %}
                    {% if 'Invoices' in useruiacl.Transactions %}
                    <li class="nav-item subsection-group" data-menu="transactions" style="display: none;">
                        <a class="nav-link" href="{% url 'r-txn-invoices' %}"
                            style="color: #6c757d; font-weight: 500; display: flex; align-items: center; padding: 8px 12px; border-radius: 6px; transition: all 0.3s ease;"
                            onmouseover="this.style.background='#f8f9fa'; this.style.color='#495057'"
                            onmouseout="this.style.background='transparent'; this.style.color='#6c757d'">
                            <i data-feather="file" style="width: 16px; height: 16px; margin-right: 6px;"></i>
                            <span>Counter Sale</span>
                        </a>
                    </li>
                    {% endif %}
                    {% endif %}

                    <!-- Inventory subsections -->
                    {% if 'Inventory' in useruiacl %}
                    <li class="nav-item subsection-group" data-menu="inventory" style="display: none;">
                        <a class="nav-link" href="{% url 'r-inventory' %}"
                            style="color: #6c757d; font-weight: 500; display: flex; align-items: center; padding: 8px 12px; border-radius: 6px; transition: all 0.3s ease;"
                            onmouseover="this.style.background='#f8f9fa'; this.style.color='#495057'"
                            onmouseout="this.style.background='transparent'; this.style.color='#6c757d'">
                            <i data-feather="bar-chart-2" style="width: 16px; height: 16px; margin-right: 6px;"></i>
                            <span>Summary</span>
                        </a>
                    </li>
                    {% if 'Current_Stock' in useruiacl.Inventory %}
                    <li class="nav-item subsection-group" data-menu="inventory" style="display: none;">
                        <a class="nav-link" href="{% url 'r-inv-current-stock' %}"
                            style="color: #6c757d; font-weight: 500; display: flex; align-items: center; padding: 8px 12px; border-radius: 6px; transition: all 0.3s ease;"
                            onmouseover="this.style.background='#f8f9fa'; this.style.color='#495057'"
                            onmouseout="this.style.background='transparent'; this.style.color='#6c757d'">
                            <i data-feather="package" style="width: 16px; height: 16px; margin-right: 6px;"></i>
                            <span>Current</span>
                        </a>
                    </li>
                    {% endif %}
                    {% if 'Stock_Outward' in useruiacl.Inventory %}
                    <li class="nav-item subsection-group" data-menu="inventory" style="display: none;">
                        <a class="nav-link" href="{% url 'r-inv-stock-outward' %}"
                            style="color: #6c757d; font-weight: 500; display: flex; align-items: center; padding: 8px 12px; border-radius: 6px; transition: all 0.3s ease;"
                            onmouseover="this.style.background='#f8f9fa'; this.style.color='#495057'"
                            onmouseout="this.style.background='transparent'; this.style.color='#6c757d'">
                            <i data-feather="arrow-up" style="width: 16px; height: 16px; margin-right: 6px;"></i>
                            <span>Outward</span>
                        </a>
                    </li>
                    {% endif %}
                    {% if 'Stock_Inward' in useruiacl.Inventory %}
                    <li class="nav-item subsection-group" data-menu="inventory" style="display: none;">
                        <a class="nav-link" href="{% url 'r-inv-stock-inward' %}"
                            style="color: #6c757d; font-weight: 500; display: flex; align-items: center; padding: 8px 12px; border-radius: 6px; transition: all 0.3s ease;"
                            onmouseover="this.style.background='#f8f9fa'; this.style.color='#495057'"
                            onmouseout="this.style.background='transparent'; this.style.color='#6c757d'">
                            <i data-feather="arrow-down" style="width: 16px; height: 16px; margin-right: 6px;"></i>
                            <span>Inward</span>
                        </a>
                    </li>
                    {% endif %}
                    {% if 'Suppliers' in useruiacl.Inventory %}
                    <li class="nav-item me-3 subsection-group" data-menu="inventory" style="display: none;">
                        <a class="nav-link" href="{% url 'r-inv-suppliers' %}"
                            style="color: #6c757d; font-weight: 500; display: flex; align-items: center; padding: 8px 12px; border-radius: 6px; transition: all 0.3s ease;"
                            onmouseover="this.style.background='#f8f9fa'; this.style.color='#495057'"
                            onmouseout="this.style.background='transparent'; this.style.color='#6c757d'">
                            <i data-feather="truck" style="width: 16px; height: 16px; margin-right: 6px;"></i>
                            <span>Suppliers</span>
                        </a>
                    </li>
                    {% endif %}
                    {% endif %}

                    <!-- Staff Summary -->
                    <!-- {% if 'Staff' in useruiacl %}
                    <li class="nav-item subsection-group" data-menu="staff" style="display: none;">
                        <a class="nav-link" href="{% url 'r-staff' %}" style="color: #6c757d; font-weight: 500; display: flex; align-items: center; padding: 8px 12px; border-radius: 6px; transition: all 0.3s ease;" onmouseover="this.style.background='#f8f9fa'; this.style.color='#495057'" onmouseout="this.style.background='transparent'; this.style.color='#6c757d'">
                            <i data-feather="bar-chart-2" style="width: 16px; height: 16px; margin-right: 6px;"></i>
                            <span>Summary</span>
                        </a>
                    </li>
                    {% endif %} -->

                </ul>

                <ul class="nav navbar-nav align-items-center ms-auto" style="flex-wrap: nowrap;">
                    <!-- Date Range Picker -->
                    <li class="nav-item ms-1 me-3">
                        <div class="input-group data-range-picker" style="max-width: 280px; padding: 0;">
                            <input type="text" class="form-control" id="dateRangePicker" placeholder="Select date range" readonly style="background: white; border: 1px solid #d8d6de; font-size: 0.857rem; padding: 0.571rem 1rem;">
                            <span class="input-group-text" style="background: #f8f9fa; border: 1px solid #d8d6de; border-left: none;">
                                <i data-feather="calendar" style="width: 16px; height: 16px; color: #6c757d;"></i>
                            </span>
                        </div>
                    </li>
                    <li class="nav-item dropdown dropdown-user">
                        <a class="nav-link dropdown-toggle dropdown-user-link" id="dropdown-user" href="#"
                            data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <div class="user-nav d-sm-flex d-none">
                                <span class="user-name fw-bolder">{{username}}</span>
                                <!-- <span class="user-status">{{userrole}}</span> -->
                            </div>
                            <span class="avatar"><img class="round"
                                    src="{% static 'custom-assets/images/profile-icon.png' %}" alt="avatar" height="40"
                                    width="40"><span class="avatar-status-online"></span></span>
                        </a>
                        <div class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-user">
                            <a class="dropdown-item" href="{% url 'r-users-profile' %}"><i class="me-50"
                                    data-feather="user"></i> Profile</a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item" href="{% url 'logout' %}"><i class="me-50"
                                    data-feather="power"></i> Logout</a>
                        </div>
                    </li>
                </ul>

            </div>
        </nav>
        <!-- END: Header-->

        <!-- BEGIN: Main Menu-->
        <div class="main-menu menu-fixed menu-light menu-accordion menu-shadow" data-scroll-to-active="true"
            style="background-color: #3b82f6 !important" id="main-sidebar">
            <div class="navbar-header">
                <ul class="nav navbar-nav flex-row">
                    <li class="nav-item me-auto">
                        <a class="navbar-brand" href="{% url 'r-home' %}"
                            style="display: flex; align-items: center; justify-content: center; padding: 10px 0;">
                            <span class="brand-logo"
                                style="background-color: white; border-radius: 8px; padding: 5px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);">
                                <img src="../../../{{ business_logo }}" alt="logo" height="40" style="display: block;">
                            </span>
                        </a>
                    </li>
                    <!-- <li class="nav-item nav-toggle">
                        <a class="nav-link modern-nav-toggle pe-0" data-bs-toggle="collapse">
                            <i class="d-block d-xl-none text-primary toggle-icon font-medium-4" data-feather="x"></i>
                            <i class="d-none d-xl-block collapse-toggle-icon font-medium-4 text-primary" data-feather="disc" data-ticon="disc"></i>
                        </a>
                    </li> -->
                </ul>
            </div>
            <div class="shadow-bottom"></div>
            <div class="main-menu-content" style="background-color: #3b82f6 !important">
                <ul class="navigation navigation-main" id="main-menu-navigation" data-menu="menu-navigation">

                    <li class="nav-item {% if request.resolver_match.url_name == 'r-home' %} active {% endif %}">
                        <a class="d-flex align-items-center" href="{% url 'r-home' %}">
                            <div class="icon-label-stack">
                                <i class="fas fa-tachometer-alt"></i>
                                <span class="menu-title" data-i18n="Home">Dashboard</span>
                            </div>
                        </a>
                    </li>

                    <li
                        class="nav-item {% if request.resolver_match.url_name == 'r-txn-job-sheets' %} active {% endif %}">
                        <a class="d-flex align-items-center" href="{% url 'r-txn-job-sheets' %}">
                            <div class="icon-label-stack">
                                <i class="fas fa-tools"></i>
                                <span class="menu-title" data-i18n="Job_Cards">Job Cards</span>
                            </div>
                        </a>
                    </li>

                    {% if 'Inventory' in useruiacl %}
                    <li
                        class="nav-item {% if 'r-inv-current-stock' in request.path or 'r-inv-stock-outward' in request.path or 'r-inv-stock-inward' in request.path or 'r-inv-suppliers' in request.path %} active {% endif %}">
                        <a class="d-flex align-items-center" href="{% url 'r-inv-current-stock' %}">
                            <div class="icon-label-stack">
                                <i class="fas fa-boxes"></i>
                                <span class="menu-title" data-i18n="Inventory">Inventory</span>
                            </div>
                        </a>
                    </li>
                    {% endif %}

                    <li
                        class="nav-item {% if request.resolver_match.url_name == 'r-accounts-bookings' %} active {% endif %}">
                        <a class="d-flex align-items-center" href="{% url 'r-accounts-bookings' %}">
                            <div class="icon-label-stack">
                                <i class="fas fa-calendar-check"></i>
                                <span class="menu-title" data-i18n="Booking">Booking</span>
                            </div>
                        </a>
                    </li>


                    {% if 'Transactions' in useruiacl %}
                    <li
                        class="nav-item {% if 'r-txn-invoices' in request.path or 'r-txn-estimates' in request.path or 'r-txn-payments' in request.path or 'r-txn-dailyreports' in request.path %} active {% endif %}">
                        <a class="d-flex align-items-center" href="{% url 'r-transactions' %}">
                            <div class="icon-label-stack">
                                <i class="fas fa-file-invoice-dollar"></i>
                                <span class="menu-title" data-i18n="Invoices">Counter Sale</span>
                            </div>
                        </a>
                    </li>
                    {% endif %}


                    <li class="nav-item {% if 'r-prf-summary' in request.path %} active {% endif %}">
                        <a class="d-flex align-items-center" href="{% url 'r-prf-summary' %}">
                            <div class="icon-label-stack">
                                <i class="fas fa-users"></i>
                                <span class="menu-title" data-i18n="Customers">Customers</span>
                            </div>
                        </a>
                    </li>


                    {% if 'Accounts' in useruiacl %}
                    <li class="nav-item {% if 'r-garage-summary' in request.path %} active {% endif %}">
                        <a class="d-flex align-items-center" href="{% url 'r-garage-summary' %}">
                            <div class="icon-label-stack">
                                <i class="fas fa-user-circle"></i>
                                <span class="menu-title" data-i18n="Profile">Profile</span>
                            </div>
                        </a>
                    </li>
                    {% endif %}



                    <li class="nav-item {% if 'r-staff' in request.path %} active {% endif %}">
                        <a class="d-flex align-items-center" href="{% url 'r-staff' %}">
                            <div class="icon-label-stack">
                                <i class="fas fa-user-friends"></i>
                                <span class="menu-title" data-i18n="Staff">Staff</span>
                            </div>
                        </a>
                    </li>




                </ul>

                <!-- Mobile Sidebar Logo -->
                <div class="sidebar-logo d-lg-none">
                    <span class="brand-logo"
                        style="background-color: white; border-radius: 10px; padding: 8px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); display: block;">
                        <img src="../../../static/custom-assets/images/bikedoot/ServXPNG.png" alt="Logo" height="50"
                            style="display: block;">
                    </span>
                </div>
            </div>
        </div>
        <!-- END: Main Menu-->

        <!--START: message-->
        {% if messages %}
        <script id="django-messages" type="application/json">
                [
                {% for message in messages %}
                    {
                        "tags": "{{ message.tags }}",
                        "message": "{{ message|escapejs }}"
                    }{% if not forloop.last %},{% endif %}
                {% endfor %}
                ]
            </script>
        {% endif %}
        <!--END: message-->
        {% block content %}{% endblock %}
        <!-- END: Content-->

        <div class="sidenav-overlay"></div>
        <div class="drag-target"></div>

        <!-- BEGIN: Footer-->
        <footer class="footer footer-static footer-light" style="justify-items: center;">
            <p class="clearfix mb-0">
                <span class="float-md-start d-block d-md-inline-block mt-25">COPYRIGHT &copy; 2025<a class="ms-25"
                        href="#" target="_blank">Bikedoot</a><span class="d-none d-sm-inline-block">, All rights
                        Reserved</span></span>
                <!-- <span class="float-md-end d-none d-md-block">Hand-crafted & Made with<i data-feather="heart"></i></span> -->
            </p>
        </footer>
        <button class="btn btn-primary btn-icon scroll-top" type="button"><i data-feather="arrow-up"></i></button>
        <!-- END: Footer-->
    </div>

    <script src="https://unpkg.com/feather-icons"></script>
    <script>
        feather.replace();
    </script>
    <script>
        // Prevent automatic feather icon replacement that triggers loading spinner
        if (typeof feather !== 'undefined') {
            feather.replace = function () {
                // Override to prevent automatic icon replacement
                return;
            };
        }
    </script>
    <script>
        // Mobile menu toggle functionality
        document.addEventListener('DOMContentLoaded', function () {
            const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
            const sidebar = document.getElementById('main-sidebar');

            if (mobileMenuToggle && sidebar) {
                mobileMenuToggle.addEventListener('click', function () {
                    sidebar.classList.toggle('show');
                    document.body.classList.toggle('menu-open');
                });
            }

            // Close menu when clicking outside
            document.addEventListener('click', function (event) {
                const isClickInside = sidebar.contains(event.target) || mobileMenuToggle.contains(event.target);
                if (!isClickInside && window.innerWidth < 992) {
                    sidebar.classList.remove('show');
                    document.body.classList.remove('menu-open');
                }
            });
        });

        // Close menu when window is resized to desktop
        window.addEventListener('resize', function () {
            if (window.innerWidth >= 992) {
                document.body.classList.remove('menu-open');
                const sidebar = document.getElementById('main-sidebar');
                if (sidebar) sidebar.classList.remove('show');
            }
        });
    </script>
    <script>
        // Robust: support Bootstrap dropdown if present; fallback to manual toggle otherwise
        document.addEventListener('DOMContentLoaded', function () {
            const trigger = document.getElementById('dropdown-user');
            const menu = trigger ? trigger.parentElement.querySelector('.dropdown-menu') : null;
            if (!trigger || !menu) return;

            const openMenu = () => {
                menu.classList.add('show');
                trigger.setAttribute('aria-expanded', 'true');
            };
            const closeMenu = () => {
                menu.classList.remove('show');
                trigger.setAttribute('aria-expanded', 'false');
            };

            // On click, let Bootstrap (if loaded) do its thing first; then ensure visibility
            trigger.addEventListener('click', function () {
                // Delay to allow any Bootstrap handler to toggle .show
                setTimeout(function () {
                    const isShown = menu.classList.contains('show');
                    if (!isShown) {
                        // Manually toggle if not shown
                        openMenu();
                    }
                }, 0);
            });

            document.addEventListener('click', function (e) {
                if (!menu.contains(e.target) && !trigger.contains(e.target)) {
                    closeMenu();
                }
            });

            document.addEventListener('keydown', function (e) {
                if (e.key === 'Escape') closeMenu();
            });
        });
    </script>
    <script>
        // Sidebar dropdown flyout: toggle on click and open on hover
        document.addEventListener('DOMContentLoaded', function () {
            const items = Array.from(document.querySelectorAll('.main-menu .nav-item.dropdown'));
            if (!items.length) return;

            const closeAll = () => {
                items.forEach(li => li.querySelectorAll('.dropdown-menu').forEach(m => m.classList.remove('show')));
            };

            items.forEach(li => {
                const toggle = li.querySelector('[data-bs-toggle="dropdown"], .dropdown-toggle') || li.querySelector('a, button');
                const menu = li.querySelector('.dropdown-menu');
                if (!toggle || !menu) return;

                // Click toggle (works even without .dropdown-toggle)
                toggle.addEventListener('click', function (e) {
                    e.preventDefault();
                    e.stopPropagation();
                    const isOpen = menu.classList.contains('show');
                    closeAll();
                    if (!isOpen) menu.classList.add('show');
                });

                // Hover open/close (desktop only)
                li.addEventListener('mouseenter', function () {
                    if (window.innerWidth >= 992) {
                        closeAll();
                        menu.classList.add('show');
                    }
                });
                li.addEventListener('mouseleave', function () {
                    if (window.innerWidth >= 992) {
                        menu.classList.remove('show');
                    }
                });
            });

            // Close on outside click / ESC
            document.addEventListener('click', function (e) {
                if (!e.target.closest('.main-menu')) closeAll();
            });
            document.addEventListener('keydown', function (e) {
                if (e.key === 'Escape') closeAll();
            });
        });
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const menuItems = document.querySelectorAll('.menu-item');
            const subsectionItems = document.querySelectorAll('.subsection-group');

            function updateSubsections(activeMenuType) {
                subsectionItems.forEach(item => {
                    item.style.display = 'none';
                });

                if (activeMenuType) {
                    const itemsToShow = document.querySelectorAll(`.subsection-group[data-menu="${activeMenuType}"]`);
                    itemsToShow.forEach(item => {
                        item.style.display = 'flex';
                    });
                }
            }

            function setActiveStates(activeMenuType) {
                menuItems.forEach(item => {
                    item.closest('.nav-item').classList.remove('active');
                });

                if (activeMenuType) {
                    const activeMenuItem = document.querySelector(`.menu-item[data-menu="${activeMenuType}"]`);
                    if (activeMenuItem) {
                        activeMenuItem.closest('.nav-item').classList.add('active');
                    }
                }
            }

            menuItems.forEach(menuItem => {
                menuItem.addEventListener('click', function (e) {
                    const menuType = this.dataset.menu;
                    updateSubsections(menuType);
                    setActiveStates(menuType);
                });
            });

            function getActiveMenuFromURL() {
                const currentPath = window.location.pathname;

                // Deactivate all subsection links first
                subsectionItems.forEach(item => item.classList.remove('active'));

                let activeMenu = null;

                // Find the matching subsection link and activate it
                for (const item of subsectionItems) {
                    const link = item.querySelector('a');
                    if (link && link.pathname === currentPath) {
                        item.classList.add('active');
                        activeMenu = item.dataset.menu;
                        break; // Found the active link, no need to continue
                    }
                }

                // If no direct match, check parent paths for sidebar activation
                if (!activeMenu) {
                    const pathMappings = {
                        'transactions': '/transactions',
                        'inventory': '/inventory',
                        'profile': '/prf-summary',
                        'jobcards': '/txn/job-sheets',
                        'dashboard': '/home',
                        'staff': '/staff'
                    };

                    for (const menu in pathMappings) {
                        if (currentPath.startsWith(pathMappings[menu])) {
                            activeMenu = menu;
                            break;
                        }
                    }
                }

                return activeMenu;
            }

            const activeMenu = getActiveMenuFromURL();
            updateSubsections(activeMenu);
            setActiveStates(activeMenu);
        });
    </script>

    <!-- <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> -->
    <script src="{% static 'app-assets/js/scripts/jquery.min.js' %}"></script>
    <!-- <script src="https://unpkg.com/feather-icons"></script> -->
    {% block script %}{% endblock %}

    <!-- BEGIN: OLD JS-->
    <script src="{% static 'app-assets/vendors/js/vendors.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/ui/jquery.sticky.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/charts/apexcharts.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/extensions/toastr.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/pickers/pickadate/picker.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/pickers/pickadate/picker.date.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/pickers/pickadate/picker.time.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/pickers/pickadate/legacy.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/pickers/flatpickr/flatpickr.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/forms/repeater/jquery.repeater.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/forms/select/select2.full.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/editors/quill/katex.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/editors/quill/highlight.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/editors/quill/quill.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/charts/chart.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/forms/cleave/cleave.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/forms/cleave/addons/cleave-phone.us.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/forms/validation/jquery.validate.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/extensions/moment.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/tables/datatable/jquery.dataTables.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/tables/datatable/dataTables.bootstrap5.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/tables/datatable/dataTables.responsive.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/tables/datatable/responsive.bootstrap5.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/tables/datatable/datatables.buttons.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/tables/datatable/jszip.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/tables/datatable/pdfmake.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/tables/datatable/vfs_fonts.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/tables/datatable/buttons.html5.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/tables/datatable/buttons.print.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/tables/datatable/dataTables.rowGroup.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/extensions/polyfill.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/tables/datatable/buttons.bootstrap5.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/tables/datatable/datatables.checkboxes.min.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/extensions/swiper.min.js' %}"></script>
    <script src="{% static 'app-assets/js/scripts/extensions/ext-component-swiper.js' %}"></script>
    <script src="{% static 'app-assets/vendors/js/extensions/jstree.min.js' %}"></script>
    <script src="{% static 'app-assets/js/core/app-menu.js' %}"></script>
    <script src="{% static 'app-assets/js/core/app.js' %}?v=0.1?v=0.1"></script>
    <script src="{% static 'app-assets/js/scripts/pages/dashboard-ecommerce.js' %}"></script>
    <script src="{% static 'app-assets/js/scripts/forms/pickers/form-pickers.js' %}"></script>
    <script src="{% static 'app-assets/js/scripts/forms/form-repeater.js' %}"></script>
    <script src="{% static 'app-assets/js/scripts/forms/form-select2.js' %}"></script>
    <script src="{% static 'app-assets/js/scripts/cards/card-advance.js' %}"></script>
    <script src="{% static 'app-assets/js/scripts/pages/app-email.js' %}"></script>
    <script src="{% static 'app-assets/js/scripts/components/components-navs.js' %}"></script>
    <script src="{% static 'app-assets/js/scripts/charts/chart-chartjs.js' %}"></script>
    <script src="{% static 'app-assets/js/scripts/pages/modal-edit-user.js' %}?v=0.1"></script>
    <script src="{% static 'app-assets/js/scripts/pages/app-user-view-account.js' %}"></script>
    <script src="{% static 'app-assets/js/scripts/pages/app-user-view.js' %}"></script>
    <script src="{% static 'app-assets/js/scripts/pages/page-profile.js' %}"></script>
    <script src="{% static 'app-assets/js/scripts/pages/modal-add-role.js' %}"></script>
    <script src="{% static 'app-assets/js/scripts/pages/app-access-roles.js' %}"></script>
    <script src="{% static 'app-assets/js/scripts/extensions/ext-component-toastr.js' %}"></script>
    <script src="{% static 'app-assets/js/scripts/pages/app-file-manager.js' %}"></script>
    <script src="{% static 'custom-assets/js/trimWhitespace.js' %}"></script>
    <script src="{% static 'custom-assets/js/datatableOrdering.js' %}"></script>
    <script src="{% static 'custom-assets/js/passwordMatch.js' %}"></script>
    <script src="{% static 'custom-assets/js/formRepeater.js' %}"></script>
    <script src="{% static 'custom-assets/js/showHideForms.js' %}"></script>
    <script src="{% static 'custom-assets/js/showHideFormsDiv.js' %}"></script>
    <script src="{% static 'custom-assets/js/startEndDatetimeValidator.js' %}"></script>
    <script src="{% static 'custom-assets/js/employeeFields.js' %}"></script>
    <script src="{% static 'custom-assets/js/validateImage.js' %}"></script>
    <script src="{% static 'custom-assets/js/currentDatetime.js' %}"></script>
    <script src="{% static 'custom-assets/js/fileValidation.js' %}"></script>
    <script src="{% static 'custom-assets/js/toastrDjangoMessages.js' %}"></script>
    <script src="{% static 'custom-assets/js/showDivSetFieldsRequired.js' %}"></script>

    <script>
        $(window).on('load', function () {
            if (feather) {
                feather.replace({
                    width: 14,
                    height: 14
                });
            }
        })
    </script>
    
    <!-- Date Range Picker Initialization -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const dateRangePicker = document.getElementById('dateRangePicker');
            
            if (dateRangePicker && typeof flatpickr !== 'undefined') {
                // Get session date range from context or use default
                const sessionStartDate = '{{ request.session.date_range_start|default:"" }}';
                const sessionEndDate = '{{ request.session.date_range_end|default:"" }}';
                const startDate = sessionStartDate ? new Date(sessionStartDate) : new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);
                const endDate = sessionEndDate ? new Date(sessionEndDate) : new Date();
                
                const fp = flatpickr(dateRangePicker, {
                    mode: 'range',
                    dateFormat: 'Y-m-d',
                    defaultDate: [startDate, endDate],
                    maxDate: 'today',
                    onReady: function(selectedDates, dateStr, instance) {
                        // Manually set input value to show range
                        const start = startDate.toISOString().split('T')[0];
                        const end = endDate.toISOString().split('T')[0];
                        dateRangePicker.value = start + ' to ' + end;
                    },
                    onChange: function(selectedDates, dateStr, instance) {
                        if (selectedDates.length === 2) {
                            // Save to session - use local date to avoid timezone issues
                            const startDate = new Date(selectedDates[0].getTime() - selectedDates[0].getTimezoneOffset() * 60000);
                            const endDate = new Date(selectedDates[1].getTime() - selectedDates[1].getTimezoneOffset() * 60000);
                            
                            fetch('/api/set-date-range/', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json',
                                    'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]')?.value || ''
                                },
                                body: JSON.stringify({
                                    start_date: startDate.toISOString().split('T')[0],
                                    end_date: endDate.toISOString().split('T')[0]
                                })
                            });
                            
                            // Trigger custom event
                            window.dispatchEvent(new CustomEvent('dateRangeChanged', {
                                detail: {
                                    startDate: selectedDates[0],
                                    endDate: selectedDates[1],
                                    dateString: dateStr
                                }
                            }));
                        }
                    }
                });
                
                // Mobile: Click icon to open picker
                const iconElement = document.querySelector('.input-group-text');
                if (iconElement) {
                    iconElement.addEventListener('click', function() {
                        fp.open();
                    });
                }
            }
        });
    </script>
    <!-- END: OLD JS-->
    <!-- END: Body-->
</body>

</html>