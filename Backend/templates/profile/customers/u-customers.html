{% extends "index.html" %}

{% block title %}Update Customer Vehicle{% endblock %}

{% block navlink %}
<li class="nav-item me-2 subsection-group" data-menu="vehicle" style="display: none;">
    <a class="nav-link" href="{% url 'r-prf-summary' %}" style="color: #6c757d; font-weight: 500; display: flex; align-items: center; padding: 8px 12px; border-radius: 6px; transition: all 0.3s ease;" onmouseover="this.style.background='#f8f9fa'; this.style.color='#495057'" onmouseout="this.style.background='transparent'; this.style.color='#6c757d'">
        <i data-feather="bar-chart-2" style="width: 16px; height: 16px; margin-right: 6px;"></i>
        <span>Summary</span>
    </a>
</li>
<li class="nav-item me-2 subsection-group" data-menu="vehicle" style="display: none;">
    <a class="nav-link" href="{% url 'r-prf-customers' %}" style="color: #6c757d; font-weight: 500; display: flex; align-items: center; padding: 8px 12px; border-radius: 6px; transition: all 0.3s ease;" onmouseover="this.style.background='#f8f9fa'; this.style.color='#495057'" onmouseout="this.style.background='transparent'; this.style.color='#6c757d'">
        <i data-feather="bar-chart-2" style="width: 16px; height: 16px; margin-right: 6px;"></i>
        <span>Customers</span>
    </a>
</li>
<li class="nav-item me-2 subsection-group" data-menu="vehicle" style="display: none;">
    <a class="nav-link" href="{% url 'r-prf-vehicles' %}" style="color: #6c757d; font-weight: 500; display: flex; align-items: center; padding: 8px 12px; border-radius: 6px; transition: all 0.3s ease;" onmouseover="this.style.background='#f8f9fa'; this.style.color='#495057'" onmouseout="this.style.background='transparent'; this.style.color='#6c757d'">
        <i data-feather="bar-chart-2" style="width: 16px; height: 16px; margin-right: 6px;"></i>
        <span>Vehicles</span>
    </a>
</li>
<li class="nav-item me-2 subsection-group" data-menu="vehicle" style="display: none;">
    <a class="nav-link" href="{% url 'u-prf-customers' customer_obj.id %}" style="color: #6c757d; font-weight: 500; display: flex; align-items: center; padding: 8px 12px; border-radius: 6px; transition: all 0.3s ease;" onmouseover="this.style.background='#f8f9fa'; this.style.color='#495057'" onmouseout="this.style.background='transparent'; this.style.color='#6c757d'">
        <i data-feather="bar-chart-2" style="width: 16px; height: 16px; margin-right: 6px;"></i>
        <span>Update Customer</span>
    </a>
</li>
{% endblock %}

{% block style %}
<style>
  /* Professional Card Styling - Enhanced */
  .card {
    background: white !important;
    border: none !important;
    border-radius: 16px !important;
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08) !important;
    overflow: hidden;
    transition: all 0.3s ease;
  }

  .card:hover {
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.12) !important;
  }

  .card-header {
    background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%) !important;
    border-bottom: 2px solid #e2e8f0 !important;
    padding: 1rem 1.25rem !important;
  }

  .card-header h6 {
    color: #1e293b !important;
    font-weight: 600 !important;
    font-size: 1rem !important;
    margin: 0;
  }

  .card-body {
    padding: 1.25rem !important;
    background: #ffffff !important;
  }

  /* Enhanced Job Header Section */
  .card-header.d-flex {
    background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%) !important;
    border-bottom: 2px solid #e2e8f0 !important;
    padding: 1.25rem !important;
  }

  /* Enhanced Form Controls */
  .form-control,
  .form-select {
    background: white !important;
    border: 2px solid #e2e8f0 !important;
    border-radius: 10px !important;
    padding: 0.625rem 0.875rem !important;
    font-size: 0.925rem !important;
    transition: all 0.2s ease !important;
    color: #1e293b !important;
  }

  .form-control:focus,
  .form-select:focus {
    border-color: #3b82f6 !important;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1) !important;
    background: white !important;
  }

  .form-control:hover:not(:focus),
  .form-select:hover:not(:focus) {
    border-color: #cbd5e1 !important;
  }

  /* Professional Labels */
  .form-label {
    color: #475569 !important;
    font-weight: 600 !important;
    font-size: 0.875rem !important;
    margin-bottom: 0.5rem !important;
    text-transform: none !important;
    letter-spacing: 0.3px;
  }

  .form-label.small {
    font-size: 0.85rem !important;
  }

  /* Enhanced Buttons */
  .btn {
    border-radius: 10px !important;
    padding: 0.625rem 1.25rem !important;
    font-weight: 500 !important;
    transition: all 0.2s ease !important;
    border: none !important;
  }

  .btn-outline-secondary {
    background: white !important;
    color: #64748b !important;
    border: 2px solid #e2e8f0 !important;
  }

  .btn-outline-secondary:hover {
    background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%) !important;
    color: #475569 !important;
    border-color: #cbd5e1 !important;
    transform: translateY(-1px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1) !important;
  }

  .btn-outline-primary {
    background: white !important;
    color: #3b82f6 !important;
    border: 2px solid #93c5fd !important;
  }

  .btn-outline-primary:hover {
    background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%) !important;
    color: white !important;
    border-color: #3b82f6 !important;
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3) !important;
  }

  .btn-sm {
    padding: 0.5rem 1rem !important;
    font-size: 0.875rem !important;
  }

  textarea.form-control {
    min-height: 80px !important;
    resize: vertical !important;
  }

  /* Professional Box Shadows */
  .shadow-sm {
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06) !important;
  }

  /* Smooth Transitions */
  * {
    transition: border-color 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
  }

  .app-content {
    background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
    min-height: 100vh;
  }

  .content-wrapper {
    background: transparent;
    padding: 0 0.75rem;
  }

  .content-body {
    background: transparent;
    border-radius: 20px;
    padding: 2rem;
    margin: 1rem;
  }

  /*---------------*/  
  /* Professional Modal Styling */
  .modal-content {
    border: none;
    border-radius: 12px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
    overflow: hidden;
  }
  .modal-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border: none;
    padding: 1.25rem 1.5rem;
    border-radius: 12px 12px 0 0;
    border-bottom: 1px solid #e9ecef;
  }
  .modal-header .modal-title {
    color: white;
    font-weight: 600;
    font-size: 1.1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  .modal-body {
    padding: 1.5rem;
    background: #f8f9fa;
  }
  /* Form Controls */
  .modal-body .form-label {
    font-weight: 600;
    color: #495057;
    font-size: 0.875rem;
    margin-bottom: 0.5rem;
    display: flex;
    align-items: center;
    gap: 0.25rem;
  }
  .modal-body .form-label .text-danger {
    color: #ff4757 !important;
  }
  .modal-body .form-control,
  .modal-body .form-select {
    border: 2px solid #e9ecef;
    border-radius: 8px;
    padding: 0.625rem 0.875rem;
    font-size: 0.925rem;
    transition: all 0.2s ease;
    background: white;
  }
  .modal-body .form-control:focus,
  .modal-body .form-select:focus {
    border-color: #667eea;
    box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.15);
    background: white;
  }
  /* Modal Footer */
  .modal-footer {
    background: white;
    border-top: 1px solid #e9ecef;
    padding: 1rem 1.5rem;
    gap: 0.75rem;
  }
  .modal-footer .btn {
    padding: 0.625rem 1.5rem;
    border-radius: 8px;
    font-weight: 500;
    transition: all 0.3s ease;
  }
  .modal-footer .btn-secondary {
    background: #f1f3f5;
    border: none;
    color: #495057;
  }
  .modal-footer .btn-secondary:hover {
    background: #e9ecef;
  }
  .modal-footer .btn-primary {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border: none;
    box-shadow: 0 4px 8px rgba(102, 126, 234, 0.3);
  }
  .modal-footer .btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(102, 126, 234, 0.4);
  }
  /*---------------*/  

/*---------------*/  
.vehicle-scroll {
  max-height: 250px; /* adjust as per design */
  overflow-y: auto;
  scrollbar-width: thin;
  scrollbar-color: #ccc transparent;
}
.vehicle-scroll::-webkit-scrollbar {
  width: 6px;
}
.vehicle-scroll::-webkit-scrollbar-thumb {
  background: #ccc;
  border-radius: 10px;
}
/*---------------*/  

/*------------------*/
@media (max-width: 991.98px) {

    /* Adjust card padding on mobile */
    .card-body {
      padding: 1rem;
    }

  }
  @media (max-width: 768px) {

    .add-top-margin {
      margin-top: 10px !important;
    }
  }

  /* Responsive adjustments */
  @media (max-width: 991.98px) {
    .content-wrapper {
      padding: 0 0.5rem;
    }

    /* Make form elements stack on mobile */
    .row>[class*='col-'] {
      flex: 0 0 100%;
      max-width: 100%;
    }

    /* Adjust form controls */
    .form-control,
    .form-select{
      width: 100% !important;
    }

    /* Make buttons full width on mobile */
    .btn-group {
      width: 100%;
      flex-wrap: wrap;
    }

    .btn-group .btn {
      flex: 1 0 auto;
      margin-bottom: 0.25rem;
    }
  }
/*---------------*/    
</style>
{% endblock %}

{% load custom_filters %}

{% load static %}

{% block content %}
<div class="app-content content ">
  <div class="content-overlay"></div>
  <div class="header-navbar-shadow"></div>
  <div class="content-wrapper container-xxl p-0">
    <div class="content-header row">
      <div class="content-header-left col-md-9 col-12 mb-2">
        <div class="row breadcrumbs-top">
          <div class="col-12">
            <h2 class="content-header-title float-start mb-0">Customers</h2>
            <div class="breadcrumb-wrapper">
              <ol class="breadcrumb">
                <li class="breadcrumb-item">
                  <a href="{% url 'r-prf-customers' %}">Customers</a>
                </li>
                <li class="breadcrumb-item active">Update Customer Vehicle
                </li>
              </ol>
            </div>
          </div>
        </div>
      </div>
      <div class="content-header-right text-md-end col-md-3 col-12 d-md-block d-none">
        <div class="mb-1 breadcrumb-right">
          <!-- Additional header buttons can go here -->
        </div>
      </div>
    </div>
    <div class="content-body" style="margin-top:-50px;">
      <section id="u-prf-customers">
        <div class="row">
              <!-- Customer Section -->
              <div class="col-12">
                <div class="card shadow-sm"
                  style="background: rgba(255, 255, 255, 0.95); border-radius: 16px; border: 1px solid rgba(226, 232, 240, 0.8); box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08); backdrop-filter: blur(10px);">
                  <div class="card-header border-bottom"
                    style="background: linear-gradient(135deg, rgba(59, 130, 246, 0.03) 0%, rgba(147, 197, 253, 0.03) 100%); border-bottom: 1px solid rgba(226, 232, 240, 0.5); border-radius: 16px 16px 0 0;">
                    <h6 class="mb-0 fw-bold text-dark">Cutomer Information</h6>
                    <button type="button" class="btn btn-icon btn-primary waves-effect" data-bs-toggle="modal" data-bs-target="#u-prf-customers-modal">
                      <i data-feather='edit'></i>
                    </button> 
                  </div>
                  <div class="card-body">
                    <ul class="list-unstyled mb-0">
                      <div class="row">
                        <div class="col-12 col-md-4">                          
                          <li class="d-flex align-items-center mb-1">
                              <span class="fw-medium me-2" style="min-width: 140px;">Full Name:</span>
                              <span class="text-muted">{{customer_obj.name|default:'-'}}</span>
                          </li>
                          <li class="d-flex align-items-center mb-1">
                              <span class="fw-medium me-2" style="min-width: 140px;">Email Address:</span>
                              <span class="text-muted">{{customer_obj.email|default:'-'}}</span>
                          </li>
                        </div>
                        <div class="col-12 col-md-4">
                          <li class="d-flex align-items-center mb-1">
                              <span class="fw-medium me-2" style="min-width: 140px;">Mobile Number:</span>
                              <span class="text-muted">{{customer_obj.phone|default:'-'}}</span>
                          </li>
                          <li class="d-flex align-items-center mb-1">
                              <span class="fw-medium me-2" style="min-width: 140px;">Address:</span>
                              <span class="text-muted">{{customer_obj.address|default:'-'}}</span>
                          </li>
                        </div>
                        <div class="col-12 col-md-4">
                          <li class="d-flex align-items-center mb-1">
                              <span class="fw-medium me-2" style="min-width: 140px;">Alternate Mobile:</span>
                              <span class="text-muted">{{customer_obj.alt_phone|default:'-'}}</span>
                          </li>
                          <li class="d-flex align-items-center">
                              <span class="fw-medium me-2" style="min-width: 140px;">Pincode:</span>
                              <span class="text-muted">{{customer_obj.pincode|default:'-'}}</span>
                          </li>
                        </div>
                      </div>
                    </ul>
                  </div>
                </div>
              </div>
              <!-- Vehicle Section -->
              <div class="col-12">
                <div class="card shadow-sm h-100"
                  style="background: rgba(255, 255, 255, 0.95); border-radius: 16px; border: 1px solid rgba(226, 232, 240, 0.8); box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08); backdrop-filter: blur(10px);">
                  <div class="card-header border-bottom"
                    style="background: linear-gradient(135deg, rgba(59, 130, 246, 0.03) 0%, rgba(147, 197, 253, 0.03) 100%); border-bottom: 1px solid rgba(226, 232, 240, 0.5); border-radius: 16px 16px 0 0;">
                    <h6 class="mb-0 fw-bold text-dark">Vehicle</h6>
                    <button type="button" class="btn btn-outline-primary btn-sm" data-bs-toggle="modal"
                      data-bs-target="#c-prf-vehicles-modal">
                      <i class="fas fa-plus me-25"></i>Add
                    </button>
                  </div>
                  <div class="card-body">
                    {% for vehicle in customer_obj.vehicle.all %}
                    <div class="border rounded p-1 mb-1"
                      style="background-color:#f8fbff">
                      <div class="d-flex justify-content-between align-items-center mb-1">
                        <div class="d-flex align-items-center">                          
                          {% if vehicle.image_path %}
                            <img class="img-fluid rounded vehicle-thumb cursor-pointer" height="40" width="40" src="../../../{{vehicle.image_path}}" alt="Vehicle Image" data-bs-toggle="modal" data-bs-target="#u-prf-vehicles-image-modal-{{ vehicle.id }}"/>
                          {% else %} 
                              <i class="fas fa-motorcycle fa-5x cursor-pointer" style="color: #fb923c" data-bs-toggle="modal" data-bs-target="#u-prf-vehicles-image-modal-{{ vehicle.id }}"></i>
                          {% endif %}                           
                          <h6 class="mb-0 set-text-color ms-1">
                            {{ vehicle.license_plate_no|default:'-' }}
                          </h6>
                        </div>
                        <div class="d-flex">
                          <button type="button" class="btn btn-icon btn-primary waves-effect me-25" data-bs-toggle="modal" data-bs-target="#u-prf-vehicles-modal-{{ vehicle.id }}">              
                            <i data-feather="edit"></i>
                          </button>
                          <form action="{% url 'd-prf-vehicles' vehicle.id %}" method="post">
                              {% csrf_token %}
                              <button type="submit" class="btn btn-icon btn-flat-danger waves-effect" onclick="return confirm('Are you sure you want to delete this vehicle?')">
                                  <i data-feather='trash-2'></i>
                              </button>
                          </form>
                        </div>
                      </div>
                      <ul class="list-unstyled mb-0">
                        <div class="row">
                          <div class="col-12 col-md-4">
                            <li class="d-flex align-items-center mb-1">
                              <span class="fw-medium me-2" style="min-width: 160px;">Model:</span>
                              <span class="text-muted">{{ vehicle.model|default:'-' }}</span>
                            </li>
                            <li class="d-flex align-items-center mb-1">
                              <span class="fw-medium me-2" style="min-width: 160px;">External Bike ID:</span>
                              <span class="text-muted">{{ vehicle.external_bikeid|default:'-' }}</span>
                            </li>
                            <li class="d-flex align-items-center mb-1">
                              <span class="fw-medium me-2" style="min-width: 160px;">Fuel Type:</span>
                              <span class="text-muted">{{ vehicle.fuel_type|default:'-' }}</span>
                            </li>
                            <li class="d-flex align-items-center mb-1">
                              <span class="fw-medium me-2" style="min-width: 160px;">Chassis No.:</span>
                              <span class="text-muted">{{ vehicle.chassis_no|default:'-' }}</span>
                            </li>
                            <li class="d-flex align-items-center mb-1">
                              <span class="fw-medium me-2" style="min-width: 160px;">Registration State:</span>
                              <span class="text-muted">{{ vehicle.reg_state|default:'-' }}</span>
                            </li>
                          </div>
                          <div class="col-12 col-md-4">
                            <li class="d-flex align-items-center mb-1">
                              <span class="fw-medium me-2" style="min-width: 160px;">Make:</span>
                              <span class="text-muted">{{ vehicle.make|default:'-' }}</span>
                            </li>
                            <li class="d-flex align-items-center mb-1">
                              <span class="fw-medium me-2" style="min-width: 160px;">Registration No.:</span>
                              <span class="text-muted">{{ vehicle.registration_no|default:'-' }}</span>
                            </li>
                            <li class="d-flex align-items-center mb-1">
                              <span class="fw-medium me-2" style="min-width: 160px;">Transmission Type:</span>
                              <span class="text-muted">{{ vehicle.transmission_type|default:'-' }}</span>
                            </li>
                            <li class="d-flex align-items-center mb-1">
                              <span class="fw-medium me-2" style="min-width: 160px;">Vin No.:</span>
                              <span class="text-muted">{{ vehicle.vin_no|default:'-' }}</span>
                            </li>
                            <li class="d-flex align-items-center">
                              <span class="fw-medium me-2" style="min-width: 160px;">Registration Expiry:</span>
                              <span class="text-muted">
                                {% if vehicle.reg_exp %}
                                  {{ vehicle.reg_exp|date:"d M Y" }}
                                {% else %}
                                  -
                                {% endif %}
                              </span>
                            </li>
                          </div>
                          <div class="col-12 col-md-4">
                            <li class="d-flex align-items-center mb-1">
                              <span class="fw-medium me-2" style="min-width: 160px;">License Plate No.:</span>
                              <span class="text-muted">{{ vehicle.license_plate_no|default:'-' }}</span>
                            </li>
                            <li class="d-flex align-items-center mb-1">
                              <span class="fw-medium me-2" style="min-width: 160px;">Year of Manufacture:</span>
                              <span class="text-muted">
                                {% if vehicle.year_of_manufacture %}
                                  {{ vehicle.year_of_manufacture }}
                                {% else %}
                                  -
                                {% endif %}
                              </span>
                            </li>
                             <li class="d-flex align-items-center mb-1">
                              <span class="fw-medium me-2" style="min-width: 160px;">Engine No.:</span>
                              <span class="text-muted">{{ vehicle.engine_no|default:'-' }}</span>
                            </li>
                            <li class="d-flex align-items-center mb-1">
                              <span class="fw-medium me-2" style="min-width: 160px;">Color:</span>
                              <span class="text-muted">{{ vehicle.color|default:'-' }}</span>
                            </li>
                          </div>
                        </div>
                      </ul>
                    </div>                                                              
                    <!-- EDIT VEHICLE -->
                    <div class="modal fade text-start" id="u-prf-vehicles-modal-{{ vehicle.id }}" tabindex="-1">
                        <div class="modal-dialog modal-dialog-centered modal-lg">
                            <div class="modal-content">
                                <div class="modal-header set-background-color">
                                  <h5 class="modal-title text-white">Edit Vehicle</h5>
                                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    <form method="post" action="{% url 'u-prf-vehicles' vehicle.id %}">
                                        {% csrf_token %}
                                        <div class="row g-2">                                  
                                            <div class="col-12 col-md-4 mb-1">
                                                <label class="form-label" for="model"><i class="fas fa-id-card me-1 text-muted"></i>Model<span class="text-danger">*</span></label>
                                                <input type="text" class="form-control" name="model" value="{{vehicle.model}}" required/>
                                            </div>
                                            <div class="col-12 col-md-4 mb-1">                                                                
                                                <label class="form-label" for="make"><i class="fas fa-id-card me-1 text-muted"></i>Make</label>
                                                <input type="text" class="form-control" name="make" value="{{vehicle.make}}">
                                            </div>
                                            <div class="col-12 col-md-4 mb-1">                                                                
                                                <label class="form-label" for="license_plate_no"><i class="fas fa-id-card me-1 text-muted"></i>License Plate No.</label>
                                                <input type="text" class="form-control" name="license_plate_no" value="{{vehicle.license_plate_no}}">
                                            </div>
                                            <div class="col-12 col-md-4 mb-1">                                                                
                                                <label class="form-label" for="external_bikeid"><i class="fas fa-id-card me-1 text-muted"></i>External Bikeid</label>
                                                <input type="text" class="form-control" name="external_bikeid" value="{{vehicle.external_bikeid}}">
                                            </div>
                                            <div class="col-12 col-md-4 mb-1">                                                                
                                                <label class="form-label" for="registration_no"><i class="fas fa-id-card me-1 text-muted"></i>Registration No.</label>
                                                <input type="text" class="form-control" name="registration_no" value="{{vehicle.registration_no}}">
                                            </div>
                                            <div class="col-12 col-md-4 mb-1">                                                                
                                                <label class="form-label" for="year_of_manufacture"><i class="fas fa-calendar me-1 text-muted"></i>Year Of Manufacture</label>
                                                <input type="text" class="form-control" name="year_of_manufacture" value="{{vehicle.year_of_manufacture}}" placeholder="e.g. 2025" pattern="^(19\\d{2}|20[0-1]\\d|202[0-5])$" title="Enter a valid 4-digit year between 1900 and 2025" maxlength="4" oninput="this.value=this.value.replace(/[^0-9]/g,'').slice(0,4);">
                                            </div>
                                            <div class="col-12 col-md-4 mb-1">                                                                
                                                <label class="form-label" for="fuel_type"><i class="fas fa-palette me-1 text-muted"></i>Fuel Type</label>
                                                <input type="text" class="form-control" name="fuel_type" value="{{vehicle.fuel_type}}">
                                            </div>
                                            <div class="col-12 col-md-4 mb-1">                                                                
                                                <label class="form-label" for="transmission_type"><i class="fas fa-id-card me-1 text-muted"></i>Transmission Type</label>
                                                <input type="text" class="form-control" name="transmission_type" value="{{vehicle.transmission_type}}">
                                            </div>
                                            <div class="col-12 col-md-4 mb-1">                                                                
                                                <label class="form-label" for="engine_no"><i class="fas fa-cog me-1 text-muted"></i>Engine No.</label>
                                                <input type="text" class="form-control" name="engine_no" value="{{vehicle.engine_no}}">
                                            </div>
                                            <div class="col-12 col-md-4 mb-1">                                                                
                                                <label class="form-label" for="chassis_no"><i class="fas fa-barcode me-1 text-muted"></i>Chassis No.</label>
                                                <input type="text" class="form-control" name="chassis_no" value="{{vehicle.chassis_no}}">
                                            </div>
                                            <div class="col-12 col-md-4 mb-1">                                                                
                                                <label class="form-label" for="vin_no"><i class="fas fa-id-card me-1 text-muted"></i>Vin No.</label>
                                                <input type="text" class="form-control" name="vin_no" value="{{vehicle.vin_no}}">
                                            </div>
                                            <div class="col-12 col-md-4 mb-1">                                                                
                                                <label class="form-label" for="color"><i class="fas fa-palette me-1 text-muted"></i>Color</label>
                                                <input type="text" class="form-control" name="color" value="{{vehicle.color}}">
                                            </div>
                                            <div class="col-12 col-md-4 mb-1">                                                                
                                                <label class="form-label" for="reg_state"><i class="fas fa-map-pin me-1 text-muted"></i>Registration State</label>
                                                <input type="text" class="form-control" name="reg_state" value="{{vehicle.reg_state}}">
                                            </div>
                                            <div class="col-12 col-md-4 mb-1">                                                                
                                                <label class="form-label" for="reg_exp"><i class="fas fa-calendar me-1 text-muted"></i>Registration Expiry</label>
                                                <input type="date" class="form-control" name="reg_exp" value="{{vehicle.reg_exp|date:'Y-m-d'}}">
                                            </div>
                                        </div>
                                        <div class="modal-footer mt-1">
                                          <button type="button" class="btn btn-label-secondary" data-bs-dismiss="modal">Cancel</button>
                                          <button type="submit" class="btn set-background-color text-white">Save Changes</button>
                                        </div>
                                    </form>    
                                </div>                                                 
                            </div>
                        </div>
                    </div>
                    <!-- EDIT VEHICLE IMAGE -->
                    <div class="modal fade text-start" id="u-prf-vehicles-image-modal-{{ vehicle.id }}" tabindex="-1">
                        <div class="modal-dialog modal-dialog-centered modal-lg">
                            <div class="modal-content">
                                <div class="modal-header set-background-color">
                                  <h5 class="modal-title text-white">Edit Vehicle Image</h5>
                                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body text-center">
                                    <!-- LIVE PREVIEW IMAGE -->
                                    {% if vehicle.image_path %}
                                      <img class="img-fluid rounded mb-1" src="../../../{{vehicle.image_path}}" alt="Vehicle Image"/>
                                    {% else %} 
                                        <i class="fas fa-motorcycle fa-5x cursor-pointer" style="color: #fb923c"></i>
                                    {% endif %} 
                                    <form method="post" action="{% url 'u-prf-vehicles' vehicle.id %}"  enctype="multipart/form-data">
                                        {% csrf_token %}
                                        <div class="row g-2"> 
                                            <div class="col-12 mb-1">
                                                <input type="file" class="form-control" name="upload_image" id="u-prf-vehicles-img-{{ vehicle.id }}" 
                                                    accept="image/*" required
                                                    onchange="validateImage(['image/jpeg', 'image/png'], 200, 200, 'u-prf-vehicles-img-{{ vehicle.id }}', 'u-prf-vehicles-img-msg-{{ vehicle.id }}', 'u-prf-vehicles-img-subbtn-{{ vehicle.id }}')">
                                                <small id="u-prf-vehicles-img-msg-{{ vehicle.id }}" class="form-text"></small>
                                            </div>
                                        </div>
                                        <div class="modal-footer mt-1">
                                          <button type="button" class="btn btn-label-secondary" data-bs-dismiss="modal">Cancel</button>
                                          <button type="submit" class="btn set-background-color text-white" id="u-prf-vehicles-img-subbtn-{{ vehicle.id }}">Save Changes</button>
                                        </div>
                                    </form>    
                                </div>                                                 
                            </div>
                        </div>
                    </div>
                    {% empty %} 
                    <div class="text-center py-5">
                      <i class="fas fa-motorcycle  fa-3x text-muted mb-1 d-block"></i>
                      <h5 class="text-muted mb-1">No Vehicle Found</h5>
                      <p class="text-muted mb-0">Click on <i class="fas fa-plus me-25"></i>icon to add vehicle</p>
                    </div>
                    {%endfor%} 
                  </div>
                </div>
              </div>
            </div>
      </section>
    </div>
  </div>
</div>
 
<!-- EDIT CUSTOMER MODAL -->
<div class="modal fade" id="u-prf-customers-modal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">
      <div class="modal-header set-background-color">
        <h5 class="modal-title text-white">Edit Customer</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form method="post" action="{% url 'u-prf-customers' customer_obj.id %}">
          {% csrf_token %}
          <!-- Customer Information Section -->
          <div class="row g-2">
            <div class="col-12 col-md-6">
              <label class="form-label">
                <i class="fas fa-user me-1 text-muted"></i>Name <span class="text-danger">*</span>
              </label>
              <input type="text" class="form-control" name="name" value="{{customer_obj.name|default:''}}"
                     placeholder="" required>
            </div>
            <div class="col-12 col-md-6">
              <label class="form-label">
                <i class="fas fa-phone me-1 text-muted"></i>Mobile Number <span class="text-danger">*</span>
              </label>
              <input type="text" class="form-control" name="phone" value="{{customer_obj.phone|default:''}}" 
                     maxlength="10" placeholder="" required>
            </div>
            <div class="col-12 col-md-6">
              <label class="form-label">
                <i class="fas fa-phone-alt me-1 text-muted"></i>Alternate Number
              </label>
              <input type="text" class="form-control" name="alt_phone" value="{{customer_obj.alt_phone|default:''}}"
                     maxlength="10" placeholder="Enter alternate mobile number">
            </div>
            <div class="col-12 col-md-6">
              <label class="form-label">
                <i class="fas fa-envelope me-1 text-muted"></i>Email
              </label>
              <input type="email" class="form-control" name="email" value="{{customer_obj.email|default:''}}"
                     placeholder="Enter email address">
            </div>
            <div class="col-12">
              <label class="form-label">
                <i class="fas fa-map-pin me-1 text-muted"></i>Pincode
              </label>
              <input type="text" class="form-control" name="pincode" value="{{customer_obj.pincode|default:''}}"
                     maxlength="6" placeholder="Enter pincode">
            </div>
            <div class="col-12">
              <label class="form-label">
                <i class="fas fa-map-marker-alt me-1 text-muted"></i>Address
              </label>
              <textarea class="form-control" name="address" 
                        rows="3" placeholder="Enter full address">{{customer_obj.address|default:''}}</textarea>
            </div>
          </div>
          <div class="modal-footer mt-1">
            <button type="button" class="btn btn-label-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="submit" class="btn set-background-color text-white">Save
              Changes</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div> 

<!-- ADD VEHICLE Modal -->
<div class="modal fade" id="c-prf-vehicles-modal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="modal-header set-background-color">
              <h5 class="modal-title text-white">Add Vehicle</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <!-- Customer Selection Section -->
                <div class="row mb-3">
                    <div class="col-12">
                        <div class="alert alert-info d-flex align-items-center">
                            <i class="fas fa-info-circle me-2"></i>
                            <div>
                                <strong>Adding vehicle to:</strong> {{customer_obj.name}} ({{customer_obj.phone}})
                                <br><small class="text-muted">This vehicle will be associated with the selected customer</small>
                            </div>
                        </div>
                    </div>
                </div>
                
                <form method="post" id="vehicleForm" action="{% url 'c-prf-vehicles' customer_obj.id %}" enctype="multipart/form-data">
                    {% csrf_token %}
                    <div class="row g-2">                                  
                        <div class="col-12 col-md-4 mb-1">
                            <label class="form-label" for="model"><i class="fas fa-id-card me-1 text-muted"></i>Model<span class="text-danger">*</span></label>
                            <input type="text" class="form-control" name="model" required/>
                        </div>
                        <div class="col-12 col-md-4 mb-1">                                                                
                            <label class="form-label" for="make"><i class="fas fa-id-card me-1 text-muted"></i>Make</label>
                            <input type="text" class="form-control" name="make">
                        </div>
                        <div class="col-12 col-md-4 mb-1">                                                                
                            <label class="form-label" for="license_plate_no"><i class="fas fa-id-card me-1 text-muted"></i>License Plate No.</label>
                            <input type="text" class="form-control" name="license_plate_no">
                        </div>
                        <div class="col-12 col-md-4 mb-1">                                                                
                            <label class="form-label" for="external_bikeid"><i class="fas fa-id-card me-1 text-muted"></i>External Bikeid</label>
                            <input type="text" class="form-control" name="external_bikeid">
                        </div>
                        <div class="col-12 col-md-4 mb-1">                                                                
                            <label class="form-label" for="registration_no"><i class="fas fa-id-card me-1 text-muted"></i>Registration No.</label>
                            <input type="text" class="form-control" name="registration_no">
                        </div>
                        <div class="col-12 col-md-4 mb-1">                                                                
                            <label class="form-label" for="year_of_manufacture"><i class="fas fa-calendar me-1 text-muted"></i>Year Of Manufacture</label>
                            <input type="text" class="form-control" name="year_of_manufacture" placeholder="e.g. 2025" pattern="^(19\\d{2}|20[0-1]\\d|202[0-5])$" title="Enter a valid 4-digit year between 1900 and 2025" maxlength="4" oninput="this.value=this.value.replace(/[^0-9]/g,'').slice(0,4);">
                        </div>
                        <div class="col-12 col-md-4 mb-1">                                                                
                            <label class="form-label" for="fuel_type"><i class="fas fa-palette me-1 text-muted"></i>Fuel Type</label>
                            <input type="text" class="form-control" name="fuel_type">
                        </div>
                        <div class="col-12 col-md-4 mb-1">                                                                
                            <label class="form-label" for="transmission_type"><i class="fas fa-id-card me-1 text-muted"></i>Transmission Type</label>
                            <input type="text" class="form-control" name="transmission_type">
                        </div>
                        <div class="col-12 col-md-4 mb-1">                                                                
                            <label class="form-label" for="engine_no"><i class="fas fa-cog me-1 text-muted"></i>Engine No.</label>
                            <input type="text" class="form-control" name="engine_no">
                        </div>
                        <div class="col-12 col-md-4 mb-1">                                                                
                            <label class="form-label" for="chassis_no"><i class="fas fa-barcode me-1 text-muted"></i>Chassis No.</label>
                            <input type="text" class="form-control" name="chassis_no">
                        </div>
                        <div class="col-12 col-md-4 mb-1">                                                                
                            <label class="form-label" for="vin_no"><i class="fas fa-id-card me-1 text-muted"></i>Vin No.</label>
                            <input type="text" class="form-control" name="vin_no">
                        </div>
                        <div class="col-12 col-md-4 mb-1">                                                                
                            <label class="form-label" for="color"><i class="fas fa-palette me-1 text-muted"></i>Color</label>
                            <input type="text" class="form-control" name="color">
                        </div>
                        <div class="col-12 col-md-4 mb-1">                                                                
                            <label class="form-label" for="reg_state"><i class="fas fa-map-pin me-1 text-muted"></i>Registration State</label>
                            <input type="text" class="form-control" name="reg_state">
                        </div>
                        <div class="col-12 col-md-4 mb-1">                                                                
                            <label class="form-label" for="reg_exp"><i class="fas fa-calendar me-1 text-muted"></i>Registration Expiry</label>
                            <input type="date" class="form-control" name="reg_exp">
                        </div>
                        <div class="col-12 mb-1">
                            <label class="form-label" for="upload_image"><i class="fas fa-upload me-1 text-muted"></i>Upload Image</label>
                            <input type="file" class="form-control" name="upload_image" id="c-prf-vehicles-img" 
                                accept="image/*" 
                                onchange="validateImage(['image/jpeg', 'image/png'], 200, 200, 'c-prf-vehicles-img', 'c-prf-vehicles-img-msg', 'c-prf-vehicles-img-subbtn')">
                            <small id="c-prf-vehicles-img-msg" class="form-text"></small>
                        </div>
                    </div>
                    <div class="modal-footer mt-1">
                      <button type="button" class="btn btn-label-secondary" data-bs-dismiss="modal">Cancel</button>
                      <button type="submit" class="btn set-background-color text-white" id="c-prf-vehicles-img-subbtn">Add Vehicle</button>
                    </div>
                </form>    
            </div>                                                 
        </div>
    </div>
</div>
{% endblock %}

{% block script %}
{% include 'profile/customers/js-vehicle-create.html' %}
{% endblock %}